# Session Journal: 2026-01-03 Outpost Evolution v1.1 â†’ v1.3

**Status:** Checkpoint
**Project:** Outpost
**Timestamp:** 2026-01-03T07:20:00Z
**Session Duration:** ~2 hours

---

## Executive Summary

Evolved Outpost from "Happy Path" scripting to "Resilient Systems Engineering" across three version increments. Fleet expanded from 3 to 4 agents. Implemented workspace isolation for true parallel execution.

---

## Version Progression

| Version | Theme | Key Changes |
|---------|-------|-------------|
| v1.1 | Fleet Expansion | Added Aider (DeepSeek Coder) as 4th agent |
| v1.2 | Reliability | Graceful error handling, constraint docs, git fixes |
| v1.3 | Parallelism | Workspace isolation - each agent gets own repo copy |

---

## v1.1: Aider Integration

**Decision:** Selected Aider + DeepSeek API over Ollama
- DeepSeek: ~$0.14/MTok (extremely cheap)
- Ollama: Requires 32GB+ RAM, SOC server only has 4GB

**Implementation:**
- Created Python venv: `/home/ubuntu/aider-env/`
- Configured DeepSeek API key: `/home/ubuntu/.config/aider/deepseek.env`
- Created dispatch-aider.sh following existing patterns
- Updated dispatch-unified.sh to include `--executor=aider`

---

## v1.2: Reliability Hardening

**Root Causes Fixed:**

| Issue | Cause | Fix |
|-------|-------|-----|
| Silent failures | `set -e` + git error | Removed set -e, explicit error handling |
| Missing output.log | Script exits early | `exec > >(tee)` at script start |
| Git ownership errors | safe.directory not set | `git config --global safe.directory "*"` |
| Codex trust check | Missing flag | Added `--skip-git-repo-check` |
| Agent misuse | No documentation | AGENTS_README.md + INTERFACE constraints |

**Observability Improvements:**
- All scripts now capture output via `tee` before any operations
- summary.json written even on failure with error details
- Graceful "warn but continue" for non-fatal git errors

---

## v1.3: Workspace Isolation

**Problem:** `--executor=all` caused race conditions
```
error: cannot lock ref 'refs/remotes/origin/main'
Another git process seems to be running in this repository
```

**Solution:** Each agent gets isolated workspace copy

**Architecture:**
```
dispatch-unified.sh
    â”‚
    â”œâ”€â†’ Pre-flight: git fetch â†’ repos/{project}/ (cache)
    â”‚   â””â”€â†’ ONE fetch, not four
    â”‚
    â””â”€â†’ export OUTPOST_CACHE_READY=1
         â”‚
         â”œâ”€â†’ Agent 1: rsync â†’ runs/{id}/workspace/
         â”œâ”€â†’ Agent 2: rsync â†’ runs/{id}/workspace/
         â”œâ”€â†’ Agent 3: rsync â†’ runs/{id}/workspace/
         â””â”€â†’ Agent 4: rsync â†’ runs/{id}/workspace/
```

**Key Design Decisions:**
1. Pre-flight cache update prevents redundant fetches
2. OUTPOST_CACHE_READY env var signals "skip fetch"
3. rsync preserves .git, faster than clone
4. Disk space traded for reliability

---

## Fleet Status

| Agent | Model | Cost | Status |
|-------|-------|------|--------|
| Claude Code | claude-opus-4-5-20251101 | $100/mo | âœ… Operational |
| OpenAI Codex | gpt-5.2-codex | $20/mo | âœ… Operational |
| Gemini CLI | gemini-3-pro-preview | $50/mo | âœ… Operational |
| Aider | deepseek/deepseek-coder | ~$0.14/MTok | âœ… Operational |

**Total:** $170/mo subscriptions + Aider API usage

---

## Server State

**SOC Server (52.44.78.2):**
- Instance: Lightsail Medium (2 vCPU, 4GB RAM)
- Disk: 68 GB free
- Outpost footprint: ~1 GB (repos + aider-env)

**Executor Directory:**
```
/home/ubuntu/claude-executor/
â”œâ”€â”€ dispatch.sh           # Claude (v1.3)
â”œâ”€â”€ dispatch-codex.sh     # Codex (v1.3)
â”œâ”€â”€ dispatch-gemini.sh    # Gemini (v1.3)
â”œâ”€â”€ dispatch-aider.sh     # Aider (v1.3)
â”œâ”€â”€ dispatch-unified.sh   # Unified (v1.3)
â”œâ”€â”€ AGENTS_README.md      # Constraint guard
â”œâ”€â”€ repos/                # Shared cache
â””â”€â”€ runs/                 # Isolated workspaces
```

---

## Files Changed

**rgsuarez/outpost:**
- scripts/*.sh (all 5 dispatchers, v1.3)
- OUTPOST_INTERFACE.md (v1.3)
- scripts/AGENTS_README.md (new)
- session-journals/2026-01-03-v1-release.md
- Tags: v1.1, v1.2, v1.3

**rgsuarez/zeOS:**
- apps/outpost/OUTPOST_SOUL.md (v1.3)
- apps/REGISTRY.json (v1.3)

---

## Verification Results

```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ðŸ“Š BATCH COMPLETE: 20260103-071301-batch-2ahy
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
Agents: 4 | Succeeded: 4 | Failed: 0
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

All agents:
- Using pre-warmed cache âœ…
- Creating isolated workspaces âœ…
- Zero race conditions âœ…
- 100% success rate âœ…

---

## Lessons Learned

1. **`set -e` is dangerous** for scripts that must always produce output
2. **Environment flags** (OUTPOST_CACHE_READY) enable coordination without coupling
3. **rsync > git clone** for local copies (faster, works offline)
4. **Disk is cheap** - trade space for reliability
5. **Guard files** (AGENTS_README.md) prevent future agents from making old mistakes

---

## Next Steps (Future Sessions)

- [ ] Cleanup job for old runs/ directories
- [ ] Shallow clones (`--depth 1`) to save disk
- [ ] Consider Ollama if server upgraded to 16GB+
- [ ] Workspace reuse option for iterative tasks

---

## Tags

v1.0 â†’ v1.1 â†’ v1.2 â†’ **v1.3** (CURRENT)
